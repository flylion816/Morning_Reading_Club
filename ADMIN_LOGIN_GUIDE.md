# ç®¡ç†åå°ç™»å½•æµ‹è¯•æŒ‡å—

**ç›®æ ‡**: éªŒè¯ Vue 3 + Vite ç®¡ç†åå°çš„ç™»å½•æµç¨‹å’Œè®¤è¯ç³»ç»Ÿæ­£å¸¸å·¥ä½œ

**æ‰€éœ€æ—¶é—´**: 10-15 åˆ†é’Ÿ

---

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. å¯åŠ¨åç«¯æœåŠ¡
```bash
cd /Users/pica_1/æˆ‘çš„åšæœäº‘/flylion/AIé¡¹ç›®å¼€å‘/ä¸ƒä¸ªä¹ æƒ¯æ™¨è¯»è¥/backend
npm run dev
```

**é¢„æœŸè¾“å‡º**:
```
âœ… MongoDB connected successfully
âœ… MySQL connected successfully
ğŸš€ Server is running on http://localhost:3000
```

### 2. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡
```bash
cd /Users/pica_1/æˆ‘çš„åšæœäº‘/flylion/AIé¡¹ç›®å¼€å‘/ä¸ƒä¸ªä¹ æƒ¯æ™¨è¯»è¥/admin
npm run dev
```

**é¢„æœŸè¾“å‡º**:
```
VITE v7.2.4  ready in 734 ms
âœ  Local:   http://localhost:5173/
```

---

## âœ… æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯• 1: è®¿é—®ç™»å½•é¡µé¢

**æ“ä½œæ­¥éª¤**:
1. åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:5173/login`
2. ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ

**éªŒè¯ç‚¹**:
- [ ] é¡µé¢æ­£å¸¸åŠ è½½ï¼Œæ˜¾ç¤ºç™»å½•è¡¨å•
- [ ] å·¦ä¾§æ˜¾ç¤ºå“ç‰Œä¿¡æ¯å’ŒåŠŸèƒ½ç‰¹æ€§
- [ ] å³ä¾§æ˜¾ç¤ºé‚®ç®±å’Œå¯†ç è¾“å…¥æ¡†
- [ ] æ˜¾ç¤º"ç™»å½•"æŒ‰é’®
- [ ] æ˜¾ç¤ºæ¼”ç¤ºè´¦å·æç¤ºä¿¡æ¯

**é¢„æœŸè¡Œä¸º**:
```
å‡¡äººæ™¨è¯»è¥
ç®¡ç†åå°

å·¦ä¾§æ˜¾ç¤ºï¼š
âœ¨ ç›´è§‚çš„æ•°æ®ç®¡ç†
ğŸ“ å®Œæ•´çš„å­¦ä¹ è·Ÿè¸ª
ğŸ“Š è¯¦ç»†çš„ç»Ÿè®¡åˆ†æ

å³ä¾§æ˜¾ç¤ºï¼š
æ¬¢è¿ç™»å½•
è¾“å…¥æ‚¨çš„å‡­è¯ä»¥è®¿é—®ç®¡ç†é¢æ¿

æ¼”ç¤ºè´¦å·ï¼šadmin@morningreading.com
æ¼”ç¤ºå¯†ç ï¼špassword123
```

---

### æµ‹è¯• 2: æµ‹è¯•æ— æ•ˆå¯†ç 

**æ“ä½œæ­¥éª¤**:
1. è¾“å…¥é‚®ç®±: `admin@morningreading.com`
2. è¾“å…¥é”™è¯¯å¯†ç : `wrongpassword`
3. ç‚¹å‡»"ç™»å½•"æŒ‰é’®

**éªŒè¯ç‚¹**:
- [ ] æ˜¾ç¤ºé”™è¯¯æç¤ºä¿¡æ¯
- [ ] é¡µé¢ä¸ä¼šè·³è½¬
- [ ] ç™»å½•æŒ‰é’®æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆå¯é€‰ï¼‰

**é¢„æœŸè¡Œä¸º**:
```
æ˜¾ç¤ºé”™è¯¯æç¤ºï¼š
"é‚®ç®±æˆ–å¯†ç é”™è¯¯"
æˆ–
"ç™»å½•å¤±è´¥"
```

---

### æµ‹è¯• 3: æˆåŠŸç™»å½•

**æ“ä½œæ­¥éª¤**:
1. æ¸…ç©ºè¡¨å•ï¼ˆå¦‚æœæœ‰ä¹‹å‰çš„å†…å®¹ï¼‰
2. è¾“å…¥é‚®ç®±: `admin@morningreading.com`
3. è¾“å…¥å¯†ç : `password123`
4. ç‚¹å‡»"ç™»å½•"æŒ‰é’®
5. ç­‰å¾…é¡µé¢è·³è½¬ï¼ˆåº”è¯¥åœ¨ 1-2 ç§’å†…ï¼‰

**éªŒè¯ç‚¹**:
- [ ] æ˜¾ç¤º"ç™»å½•æˆåŠŸ"æç¤º
- [ ] é¡µé¢è·³è½¬åˆ°ä»ªè¡¨æ¿ (`http://localhost:5173/`)
- [ ] ä»ªè¡¨æ¿æ­£å¸¸æ˜¾ç¤ºï¼ˆä¸ä¼šå†æ¬¡è·³å›ç™»å½•é¡µï¼‰
- [ ] é¡¶éƒ¨æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯æˆ–ç™»å‡ºæŒ‰é’®ï¼ˆå¦‚æœå·²å®ç°ï¼‰

**é¢„æœŸè¡Œä¸º**:
```
1. æ˜¾ç¤º"ç™»å½•æˆåŠŸ"çš„ç»¿è‰²æç¤º
2. é¡µé¢è‡ªåŠ¨è·³è½¬åˆ°ä»ªè¡¨æ¿
3. URL å˜ä¸º http://localhost:5173/
4. ä»ªè¡¨æ¿é¡µé¢åŠ è½½å¹¶æ˜¾ç¤ºæ•°æ®
```

**âš ï¸ é‡è¦**: æ­¤å¤„æµ‹è¯• 100ms å»¶è¿Ÿä¿®å¤æ˜¯å¦æœ‰æ•ˆ
- å¦‚æœç™»å½•æˆåŠŸå"é—ªäº†ä¸€ä¸‹åˆè·³å›ç™»å½•é¡µ"ï¼Œè¯´æ˜å»¶è¿Ÿä¸è¶³æˆ–å…¶ä»–é—®é¢˜
- å¦‚æœé¡µé¢å¹³ç¨³è·³è½¬åˆ°ä»ªè¡¨æ¿ï¼Œè¯´æ˜ä¿®å¤æˆåŠŸ

---

### æµ‹è¯• 4: é¡µé¢åˆ·æ–°æŒä¹…åŒ–

**æ“ä½œæ­¥éª¤**:
1. ç¡®ä¿å·²æˆåŠŸç™»å½•å¹¶åœ¨ä»ªè¡¨æ¿é¡µé¢
2. åˆ·æ–°é¡µé¢ (F5 æˆ– Cmd+R)
3. ç­‰å¾…é¡µé¢é‡æ–°åŠ è½½

**éªŒè¯ç‚¹**:
- [ ] é¡µé¢åˆ·æ–°åä»ç„¶åœ¨ä»ªè¡¨æ¿ï¼ˆä¸ä¼šè·³å›ç™»å½•é¡µï¼‰
- [ ] Token ä» localStorage æ­£ç¡®æ¢å¤
- [ ] é¡µé¢å†…å®¹æ­£å¸¸åŠ è½½

**é¢„æœŸè¡Œä¸º**:
```
1. åˆ·æ–°é¡µé¢
2. é¡µé¢åŠ è½½ä¸­...
3. é¡µé¢åŠ è½½å®Œæˆï¼Œä»ç„¶æ˜¾ç¤ºä»ªè¡¨æ¿
4. å¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–æ“ä½œ
```

---

### æµ‹è¯• 5: ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±

**æ“ä½œæ­¥éª¤**:
1. ç™»å‡ºï¼ˆå¦‚æœæœ‰å®ç°ï¼‰æˆ–å…³é—­æµè§ˆå™¨
2. æ¸…é™¤ localStorage (F12 â†’ Application â†’ Local Storage â†’ åˆ é™¤ adminToken)
3. ç›´æ¥è®¿é—® `http://localhost:5173/` (ä»ªè¡¨æ¿)

**éªŒè¯ç‚¹**:
- [ ] è‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µ (`http://localhost:5173/login`)
- [ ] æ˜¾ç¤ºç™»å½•è¡¨å•

**é¢„æœŸè¡Œä¸º**:
```
1. è®¿é—® http://localhost:5173/
2. é¡µé¢è‡ªåŠ¨è·³è½¬åˆ° /login
3. æ˜¾ç¤ºç™»å½•è¡¨å•
```

---

### æµ‹è¯• 6: å·²ç™»å½•çŠ¶æ€è®¿é—®ç™»å½•é¡µ

**æ“ä½œæ­¥éª¤**:
1. ç¡®ä¿å·²æˆåŠŸç™»å½•
2. åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ `http://localhost:5173/login`

**éªŒè¯ç‚¹**:
- [ ] è‡ªåŠ¨é‡å®šå‘å›ä»ªè¡¨æ¿ (`http://localhost:5173/`)
- [ ] ä¸æ˜¾ç¤ºç™»å½•é¡µé¢

**é¢„æœŸè¡Œä¸º**:
```
1. è®¿é—® /login
2. ç”±äºå·²è®¤è¯ï¼Œè‡ªåŠ¨è·³è½¬åˆ° /
3. æ˜¾ç¤ºä»ªè¡¨æ¿
```

---

## ğŸ” æŠ€æœ¯éªŒè¯

### API è¯·æ±‚éªŒè¯

**æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·** (F12):

1. åˆ‡æ¢åˆ° "Network" æ ‡ç­¾
2. ç™»å½•æ—¶è§‚å¯Ÿç½‘ç»œè¯·æ±‚

**é¢„æœŸè¯·æ±‚**:
```
POST http://localhost:3000/api/v1/auth/admin/login
Headers:
  Content-Type: application/json
Body:
  {
    "email": "admin@morningreading.com",
    "password": "password123"
  }

Response (200):
  {
    "code": 200,
    "message": "ç™»å½•æˆåŠŸ",
    "data": {
      "token": "eyJhbGciOiJIUzI1NiIs...",
      "admin": {
        "_id": "...",
        "name": "ç³»ç»Ÿç®¡ç†å‘˜",
        "email": "admin@morningreading.com",
        "role": "superadmin",
        ...
      }
    },
    "timestamp": 1763768190369
  }
```

### Pinia Store éªŒè¯

**æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·** (F12):

1. åˆ‡æ¢åˆ° "Console" æ ‡ç­¾
2. ç™»å½•åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ store çŠ¶æ€:

```javascript
// æ£€æŸ¥ Pinia store
const app = document.getElementById('app').__vue_app__;
const pinia = app.config.globalProperties.$pinia;
const authStore = pinia.state.value.auth;

console.log('adminToken:', authStore.adminToken);
console.log('isAuthenticated:', authStore.isAuthenticated);
console.log('adminInfo:', authStore.adminInfo);
```

**é¢„æœŸè¾“å‡º**:
```javascript
adminToken: "eyJhbGciOiJIUzI1NiIs..." // æœ‰æ•ˆçš„ JWT token
isAuthenticated: true
adminInfo: {
  _id: "...",
  name: "ç³»ç»Ÿç®¡ç†å‘˜",
  email: "admin@morningreading.com",
  role: "superadmin",
  ...
}
```

### localStorage éªŒè¯

**æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·** (F12):

1. åˆ‡æ¢åˆ° "Application" æ ‡ç­¾
2. å±•å¼€ "Local Storage"
3. é€‰æ‹© `http://localhost:5173`
4. æŸ¥çœ‹ `adminToken` çš„å€¼

**é¢„æœŸ**:
- Key: `adminToken`
- Value: JWT token (ä»¥ `eyJ...` å¼€å¤´çš„é•¿å­—ç¬¦ä¸²)

---

## âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: è®¿é—®ç™»å½•é¡µæ˜¾ç¤º "Network Error"

**åŸå› **:
- åç«¯æœåŠ¡æœªå¯åŠ¨
- åç«¯ç«¯å£ 3000 è¢«å ç”¨

**è§£å†³**:
```bash
# æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
curl http://localhost:3000/api/v1/health

# å¦‚æœå¤±è´¥ï¼Œå¯åŠ¨åç«¯
cd backend && npm run dev

# å¦‚æœç«¯å£è¢«å ç”¨ï¼Œæ€æ­»å ç”¨çš„è¿›ç¨‹
lsof -i :3000 | grep -v COMMAND | awk '{print $2}' | xargs kill -9
```

---

### é—®é¢˜ 2: ç™»å½•æˆåŠŸåç«‹å³è·³å›ç™»å½•é¡µ

**åŸå› ** (å·²ä¿®å¤):
- Vue å“åº”å¼ç³»ç»Ÿæœªå®ŒæˆçŠ¶æ€æ›´æ–°ï¼Œè·¯ç”±å®ˆå«å°±æ£€æŸ¥äº† isAuthenticated
- è§£å†³: åœ¨ LoginView.vue ä¸­æ·»åŠ  100ms å»¶è¿Ÿ

**éªŒè¯ä¿®å¤**:
1. æ£€æŸ¥ LoginView.vue ç¬¬ 135 è¡Œæ˜¯å¦æœ‰å»¶è¿Ÿä»£ç :
   ```typescript
   await new Promise(resolve => setTimeout(resolve, 100))
   ```
2. å¦‚æœä»æœ‰é—®é¢˜ï¼Œå¯ä»¥å¢åŠ å»¶è¿Ÿæ—¶é—´åˆ° 200ms

---

### é—®é¢˜ 3: é¡µé¢åˆ·æ–°åä»ç„¶åœ¨ä»ªè¡¨æ¿ï¼Œä½†æ˜¾ç¤º 404

**åŸå› **:
- Vite å¼€å‘æœåŠ¡å™¨è·¯ç”±é…ç½®é—®é¢˜

**è§£å†³**:
1. æ£€æŸ¥ `vite.config.ts` ä¸­æ˜¯å¦é…ç½®äº† SPA è·¯ç”±å›é€€
2. é‡æ–°å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡:
   ```bash
   cd admin && npm run dev
   ```

---

### é—®é¢˜ 4: Token æ˜¾ç¤ºä¸º undefined æˆ–é”™è¯¯

**åŸå› **:
- API å“åº”æ‹¦æˆªå™¨æœªæ­£ç¡®è§£æå“åº”æ•°æ®

**è§£å†³**:
1. æ£€æŸ¥ `admin/src/services/api.ts` ç¬¬ 34-37 è¡Œ:
   ```typescript
   if (response.data && typeof response.data === 'object' && 'data' in response.data) {
     return response.data.data
   }
   return response.data
   ```
2. åœ¨æµè§ˆå™¨ Console ä¸­æŸ¥çœ‹å®é™…å“åº”ç»“æ„

---

## ğŸ“Š æ€§èƒ½æ£€æŸ¥

### ç™»å½•å“åº”æ—¶é—´

**é¢„æœŸ**:
- API è¯·æ±‚: < 200ms
- é¡µé¢è·³è½¬: < 1 ç§’
- ä»ªè¡¨æ¿åŠ è½½: < 2 ç§’

**æµ‹è¯•æ–¹æ³•**:
åœ¨ Network æ ‡ç­¾ä¸­æŸ¥çœ‹å„ä¸ªè¯·æ±‚çš„æ—¶é—´

### æµè§ˆå™¨æ§åˆ¶å°

**é¢„æœŸ**:
- æ—  JavaScript é”™è¯¯
- æ—  CORS é”™è¯¯
- å¯èƒ½æœ‰ Vite HMR æ¶ˆæ¯ï¼ˆæ­£å¸¸ï¼‰

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```
æµ‹è¯•æ—¥æœŸ: 2025-11-22
æµ‹è¯•è€…: [åå­—]
æµè§ˆå™¨: Chrome 119.x / Firefox 121.x
åç«¯ç‰ˆæœ¬: main @ commit 6f18528
å‰ç«¯ç‰ˆæœ¬: main @ commit 6f18528

## æµ‹è¯•ç»“æœ

### ç™»å½•é¡µé¢
- [x] é¡µé¢åŠ è½½æ­£å¸¸
- [x] è¡¨å•éªŒè¯æ­£ç¡®
- [x] æ— æ•ˆå¯†ç æ˜¾ç¤ºé”™è¯¯
- å¤‡æ³¨: _____________

### æˆåŠŸç™»å½•
- [x] æ˜¾ç¤ºæˆåŠŸæç¤º
- [x] è·³è½¬åˆ°ä»ªè¡¨æ¿
- [x] ä¸ä¼šå†è·³å›ç™»å½•é¡µ âœ… (100mså»¶è¿Ÿä¿®å¤éªŒè¯é€šè¿‡)
- å¤‡æ³¨: _____________

### é¡µé¢åˆ·æ–°
- [x] åˆ·æ–°åä»åœ¨ä»ªè¡¨æ¿
- [x] Token è¢«æ­£ç¡®ä¿å­˜
- å¤‡æ³¨: _____________

### è·¯ç”±ä¿æŠ¤
- [x] æœªç™»å½•æ— æ³•è®¿é—®å—ä¿æŠ¤è·¯ç”±
- [x] å·²ç™»å½•æ— æ³•è®¿é—®ç™»å½•é¡µ
- å¤‡æ³¨: _____________

## æ€»ä½“è¯„ä»·
[ ] é€šè¿‡ - å¯ä»¥ç»§ç»­æµ‹è¯•å…¶ä»–åŠŸèƒ½
[ ] é€šè¿‡ä½†æœ‰å°é—®é¢˜ - éœ€è¦ä¿®å¤åå†æµ‹è¯•
[ ] ä¸é€šè¿‡ - ç™»å½•ç³»ç»Ÿæœ‰ä¸¥é‡é—®é¢˜
```

---

## âœ… éªŒæ”¶æ ‡å‡†

é¡¹ç›®è®¤è¯ç³»ç»Ÿå¯è§†ä¸ºå®Œæˆå½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:

1. **ç™»å½•æµç¨‹å®Œæ•´** - ä»è¾“å…¥å‡­è¯åˆ°è·³è½¬ä»ªè¡¨æ¿å…¨éƒ¨æ­£å¸¸
2. **è®¤è¯æŒä¹…åŒ–** - åˆ·æ–°åä¸ä¸¢å¤± Tokenï¼Œèƒ½æ¢å¤ç™»å½•çŠ¶æ€
3. **è·¯ç”±ä¿æŠ¤ç”Ÿæ•ˆ** - æœªç™»å½•æ— æ³•è®¿é—®å—ä¿æŠ¤é¡µé¢ï¼Œå·²ç™»å½•æ— æ³•è®¿é—®ç™»å½•é¡µ
4. **æ²¡æœ‰çŠ¶æ€åŒæ­¥é—®é¢˜** - ç™»å½•åä¸ä¼šç«‹å³è·³å›ç™»å½•é¡µ
5. **é”™è¯¯å¤„ç†å®Œå–„** - æ— æ•ˆå‡­è¯æ˜¾ç¤ºæ¸…æ™°çš„é”™è¯¯æç¤º
6. **æ€§èƒ½è¾¾æ ‡** - API å“åº” < 200msï¼Œé¡µé¢è·³è½¬ < 1s

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `admin/src/views/LoginView.vue` - ç™»å½•é¡µé¢ (ç¬¬ 135 è¡Œ: 100ms å»¶è¿Ÿ)
- `admin/src/stores/auth.ts` - Pinia è®¤è¯ store
- `admin/src/services/api.ts` - Axios æ‹¦æˆªå™¨ (ç¬¬ 34-37 è¡Œ: å“åº”è§£æ)
- `admin/src/router/index.ts` - è·¯ç”±å®ˆå« (ç¬¬ 68-84 è¡Œ: è®¤è¯æ£€æŸ¥)
- `backend/src/controllers/admin.controller.js` - åç«¯ç™»å½•é€»è¾‘

---

## ğŸ’¡ ä¿®å¤è®°å½•

### é—®é¢˜: ç™»å½•åç«‹å³è·³å›ç™»å½•é¡µ
**ä¿®å¤ Commit**: `6f18528` (2025-11-22)

**æ ¹æœ¬åŸå› **:
- è·¯ç”±å®ˆå«åœ¨ Vue å“åº”å¼ç³»ç»Ÿå®Œæˆæ›´æ–°å‰æ‰§è¡Œ
- `authStore.isAuthenticated` è®¡ç®—å±æ€§æœªåŠæ—¶æ›´æ–°

**è§£å†³æ–¹æ¡ˆ**:
- åœ¨ LoginView.vue çš„ handleLogin ä¸­æ·»åŠ  100ms å»¶è¿Ÿ
- ç¡®ä¿ Vue æœ‰è¶³å¤Ÿæ—¶é—´æ›´æ–°å“åº”å¼æ•°æ®

**ä»£ç ä¿®æ”¹**:
```typescript
// ç­‰å¾… Vue æ›´æ–° store åå†è·³è½¬ï¼Œç¡®ä¿ isAuthenticated å·²æ›´æ–°
await new Promise(resolve => setTimeout(resolve, 100))
router.push('/')
```

---

**æµ‹è¯•å®Œæˆå**:
- å¡«å†™ä¸Šè¿°æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿
- å¦‚æœ‰é—®é¢˜ï¼Œåˆ›å»ºç›¸åº”çš„ GitHub Issue
- é€šè¿‡æ‰€æœ‰éªŒæ”¶æ ‡å‡†åï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€é˜¶æ®µå¼€å‘

