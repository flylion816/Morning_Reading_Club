# æ™¨è¯»è¥å°ç¨‹åº - å‰ç«¯ç»„ä»¶åº“ v1.0

**é¡¹ç›®åç§°**ï¼šæ™¨è¯»è¥å°ç¨‹åº  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**ç¼–åˆ¶æ—¥æœŸ**ï¼š2025å¹´10æœˆ30æ—¥  
**é€‚ç”¨èŒƒå›´**ï¼šå‰ç«¯å¼€å‘å›¢é˜Ÿ  
**å¼€å‘æ¡†æ¶**ï¼šå¾®ä¿¡å°ç¨‹åºåŸç”Ÿæ¡†æ¶  
**æ–‡æ¡£çŠ¶æ€**ï¼šâœ… å‡†å¤‡è¿›å…¥å¼€å‘é˜¶æ®µ

---

## ç›®å½•

1. [ç»„ä»¶åº“æ¦‚è¿°](#1-ç»„ä»¶åº“æ¦‚è¿°)
2. [è®¾è®¡ç³»ç»Ÿä¸è§„èŒƒ](#2-è®¾è®¡ç³»ç»Ÿä¸è§„èŒƒ)
3. [åŸºç¡€ç»„ä»¶](#3-åŸºç¡€ç»„ä»¶)
4. [ä¸šåŠ¡ç»„ä»¶](#4-ä¸šåŠ¡ç»„ä»¶)
5. [é¡µé¢æ¨¡æ¿](#5-é¡µé¢æ¨¡æ¿)
6. [å·¥å…·å‡½æ•°åº“](#6-å·¥å…·å‡½æ•°åº“)
7. [æ ·å¼å˜é‡ä¸ä¸»é¢˜](#7-æ ·å¼å˜é‡ä¸ä¸»é¢˜)
8. [ç»„ä»¶å¼€å‘è§„èŒƒ](#8-ç»„ä»¶å¼€å‘è§„èŒƒ)
9. [æ€§èƒ½ä¼˜åŒ–æŒ‡å—](#9-æ€§èƒ½ä¼˜åŒ–æŒ‡å—)

---

# 1 ç»„ä»¶åº“æ¦‚è¿°

## 1.1 ç»„ä»¶åº“æ¶æ„

```
components/
â”œâ”€â”€ base/                    # åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ button/
â”‚   â”œâ”€â”€ input/
â”‚   â”œâ”€â”€ image/
â”‚   â”œâ”€â”€ icon/
â”‚   â””â”€â”€ loading/
â”œâ”€â”€ business/                # ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ course-card/
â”‚   â”œâ”€â”€ checkin-card/
â”‚   â”œâ”€â”€ comment-item/
â”‚   â”œâ”€â”€ user-profile/
â”‚   â”œâ”€â”€ insight-card/
â”‚   â””â”€â”€ share-card/
â”œâ”€â”€ layout/                  # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ navbar/
â”‚   â”œâ”€â”€ tabbar/
â”‚   â”œâ”€â”€ container/
â”‚   â””â”€â”€ modal/
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ formatters.js
â”‚   â”œâ”€â”€ validators.js
â”‚   â”œâ”€â”€ request.js
â”‚   â””â”€â”€ storage.js
â””â”€â”€ styles/                  # æ ·å¼ç³»ç»Ÿ
    â”œâ”€â”€ variables.wxss
    â”œâ”€â”€ common.wxss
    â””â”€â”€ animations.wxss
```

## 1.2 ç»„ä»¶åº“ç‰¹ç‚¹

- **è½»é‡åŒ–è®¾è®¡**ï¼šå……åˆ†åˆ©ç”¨å¾®ä¿¡å°ç¨‹åºåŸç”Ÿèƒ½åŠ›ï¼Œå‡å°‘ç¬¬ä¸‰æ–¹ä¾èµ–
- **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–åˆå§‹åŠ è½½ã€å†…å­˜å ç”¨å’Œè¿è¡Œæ•ˆç‡
- **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ç»„ä»¶åˆ’åˆ†å’Œå‘½åè§„èŒƒ
- **æ˜“æ‰©å±•æ€§**ï¼šæ”¯æŒå¿«é€Ÿå¢åŠ æ–°çš„ä¸šåŠ¡ç»„ä»¶
- **æ— éšœç¢æ€§**ï¼šæ”¯æŒå±å¹•é˜…è¯»å™¨å’Œé”®ç›˜æ“ä½œ

---

# 2 è®¾è®¡ç³»ç»Ÿä¸è§„èŒƒ

## 2.1 é¢œè‰²ç³»ç»Ÿ

```wxss
/* ä¸»è‰²ç³» */
--color-primary: #FF6B6B;      /* å“ç‰Œçº¢ */
--color-primary-light: #FFE5E5; /* æµ…çº¢ */
--color-primary-dark: #CC5555;  /* æ·±çº¢ */

/* è¾…åŠ©è‰² */
--color-success: #51CF66;       /* æˆåŠŸç»¿ */
--color-warning: #FFD93D;       /* è­¦å‘Šé»„ */
--color-error: #FF6B6B;         /* é”™è¯¯çº¢ */
--color-info: #4ECDC4;          /* ä¿¡æ¯è“ */

/* ä¸­ç«‹è‰² */
--color-text-primary: #1F2937;   /* ä¸»æ–‡æœ¬ */
--color-text-secondary: #6B7280; /* æ¬¡æ–‡æœ¬ */
--color-text-tertiary: #9CA3AF;  /* è¾…åŠ©æ–‡æœ¬ */
--color-border: #E5E7EB;         /* è¾¹æ¡†è‰² */
--color-bg-primary: #FFFFFF;     /* ä¸»èƒŒæ™¯ */
--color-bg-secondary: #F9FAFB;   /* æ¬¡èƒŒæ™¯ */
--color-bg-tertiary: #F3F4F6;    /* è¾…åŠ©èƒŒæ™¯ */
```

## 2.2 å­—ä½“ç³»ç»Ÿ

```wxss
/* å­—ä½“å®šä¹‰ */
--font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;

/* å­—å·è§„èŒƒ */
--font-size-xs: 24rpx;    /* æå° */
--font-size-sm: 26rpx;    /* å° */
--font-size-base: 28rpx;  /* åŸºç¡€ */
--font-size-lg: 32rpx;    /* å¤§ */
--font-size-xl: 36rpx;    /* ç‰¹å¤§ */
--font-size-2xl: 40rpx;   /* è¶…å¤§ */

/* å­—é‡ */
--font-weight-normal: 400;
--font-weight-medium: 500;
--font-weight-semibold: 600;
--font-weight-bold: 700;

/* è¡Œé«˜ */
--line-height-tight: 1.25;
--line-height-normal: 1.5;
--line-height-relaxed: 1.75;
```

## 2.3 é—´è·ç³»ç»Ÿ

```wxss
/* é—´è· - 8px åŸºç¡€ç½‘æ ¼ */
--spacing-xs: 4rpx;    /* 4px */
--spacing-sm: 8rpx;    /* 8px */
--spacing-md: 12rpx;   /* 12px */
--spacing-lg: 16rpx;   /* 16px */
--spacing-xl: 24rpx;   /* 24px */
--spacing-2xl: 32rpx;  /* 32px */
--spacing-3xl: 48rpx;  /* 48px */
```

## 2.4 åœ†è§’ç³»ç»Ÿ

```wxss
--radius-sm: 4rpx;
--radius-md: 8rpx;
--radius-lg: 12rpx;
--radius-xl: 16rpx;
--radius-full: 9999rpx;
```

## 2.5 é˜´å½±ç³»ç»Ÿ

```wxss
--shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
--shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
--shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.15);
--shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.2);
```

---

# 3 åŸºç¡€ç»„ä»¶

## 3.1 Button æŒ‰é’®ç»„ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<!-- ä¸»æŒ‰é’® -->
<v-button 
  type="primary" 
  size="large" 
  bind:click="handleClick"
  loading="{{isLoading}}"
>
  ç«‹å³æ‰“å¡
</v-button>

<!-- æ¬¡æŒ‰é’® -->
<v-button type="secondary" size="medium">
  å–æ¶ˆ
</v-button>

<!-- åŠ è½½æ€ -->
<v-button 
  type="primary" 
  loading="true" 
  disabled="true"
>
  åŠ è½½ä¸­...
</v-button>

<!-- å±é™©æ“ä½œ -->
<v-button type="danger" size="small">
  åˆ é™¤
</v-button>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    type: {
      type: String,
      value: 'primary',
      observer(newVal) {
        // primary, secondary, danger, ghost
      }
    },
    size: {
      type: String,
      value: 'medium'
      // small, medium, large
    },
    disabled: Boolean,
    loading: Boolean,
    shape: {
      type: String,
      value: 'default'
      // default, round, square
    },
    plain: Boolean,  // å¹½çµæŒ‰é’®
    width: String,   // è‡ªå®šä¹‰å®½åº¦
    icon: String,    // å›¾æ ‡åç§°
  },
  methods: {
    handleTap() {
      if (!this.data.disabled && !this.data.loading) {
        this.triggerEvent('click');
      }
    }
  }
});
```

### æ ·å¼å®ç°

```wxss
.v-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-md) var(--spacing-lg);
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  font-family: var(--font-family);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all 0.3s ease;
  min-height: 44px;
  white-space: nowrap;
}

/* ç±»å‹æ ·å¼ */
.v-button--primary {
  background: var(--color-primary);
  color: white;
}

.v-button--primary:active {
  background: var(--color-primary-dark);
  transform: scale(0.98);
}

.v-button--secondary {
  background: var(--color-bg-secondary);
  color: var(--color-text-primary);
  border-color: var(--color-border);
}

/* å¤§å°å˜ä½“ */
.v-button--small {
  padding: 6px 12px;
  font-size: var(--font-size-sm);
  min-height: 32px;
}

.v-button--large {
  padding: 12px 24px;
  font-size: var(--font-size-lg);
  min-height: 48px;
  width: 100%;
}

/* ç¦ç”¨çŠ¶æ€ */
.v-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* åŠ è½½çŠ¶æ€ */
.v-button--loading {
  opacity: 0.7;
  pointer-events: none;
}
```

## 3.2 Input è¾“å…¥æ¡†ç»„ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-input
  type="text"
  placeholder="è¯·è¾“å…¥å†…å®¹"
  value="{{inputValue}}"
  bind:input="handleInput"
  bind:blur="handleBlur"
  clearable="true"
  maxlength="100"
/>

<v-input
  type="textarea"
  placeholder="è¯·è¾“å…¥è¯„è®º"
  value="{{comment}}"
  bind:input="handleCommentInput"
  rows="4"
/>

<v-input
  type="password"
  placeholder="è¯·è¾“å…¥å¯†ç "
  value="{{password}}"
  bind:input="handlePasswordInput"
/>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    type: {
      type: String,
      value: 'text'
      // text, number, email, password, textarea
    },
    value: String,
    placeholder: String,
    disabled: Boolean,
    readonly: Boolean,
    clearable: Boolean,
    maxlength: {
      type: Number,
      value: -1
    },
    rows: {
      type: Number,
      value: 3
    },
    showCount: Boolean,
    error: Boolean,
    errorMessage: String,
    leftIcon: String,
    rightIcon: String
  },
  data() {
    return {
      focus: false,
      inputValue: this.data.value
    };
  },
  methods: {
    handleInput(e) {
      const value = e.detail.value;
      this.setData({ inputValue: value });
      this.triggerEvent('input', { value });
    },
    handleClear() {
      this.setData({ inputValue: '' });
      this.triggerEvent('clear');
      this.triggerEvent('input', { value: '' });
    }
  }
});
```

## 3.3 Image å›¾ç‰‡ç»„ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-image
  src="https://example.com/image.jpg"
  width="300"
  height="200"
  lazy-load="true"
  mode="aspectFill"
  bind:load="handleLoad"
  bind:error="handleError"
/>

<v-image
  src="{{avatarUrl}}"
  width="80"
  height="80"
  mode="aspectFill"
  shape="circle"
  showSkeleton="true"
/>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    src: String,
    width: String,
    height: String,
    mode: {
      type: String,
      value: 'aspectFill'
      // scaleToFill, aspectFill, aspectFit, widthFix, heightFix, top, bottom, center, left, right, top left, top right, bottom left, bottom right
    },
    shape: {
      type: String,
      value: 'rect'
      // rect, circle
    },
    lazyLoad: Boolean,
    webp: Boolean,
    showSkeleton: Boolean,
    placeholder: String,
    showError: Boolean
  }
});
```

### å®ç°è¦ç‚¹

```javascript
methods: {
  handleLoad(e) {
    // åŠ è½½å®Œæˆåï¼Œéšè—éª¨æ¶å±
    this.setData({ showSkeleton: false });
    this.triggerEvent('load', e.detail);
  },
  handleError(e) {
    console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', this.data.src);
    this.triggerEvent('error', e.detail);
  }
}
```

## 3.4 Loading åŠ è½½ç»„ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<!-- å¾®å‹åŠ è½½ -->
<v-loading type="spinner" size="small" />

<!-- å¤§å‹åŠ è½½ -->
<v-loading type="spinner" size="large" text="åŠ è½½ä¸­..." />

<!-- è‡ªå®šä¹‰åŠ è½½ -->
<v-loading type="dots" size="medium" />
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    type: {
      type: String,
      value: 'spinner'
      // spinner, dots, ring
    },
    size: {
      type: String,
      value: 'medium'
      // small, medium, large
    },
    text: String,
    color: {
      type: String,
      value: 'var(--color-primary)'
    }
  }
});
```

## 3.5 Icon å›¾æ ‡ç»„ä»¶

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-icon name="star" size="24" color="var(--color-primary)" />
<v-icon name="heart" size="20" />
<v-icon name="check-circle" size="32" />
```

### æ”¯æŒçš„å›¾æ ‡åˆ—è¡¨

```javascript
const ICONS = {
  'star': 'â­',
  'heart': 'â¤ï¸',
  'check': 'âœ“',
  'check-circle': 'âœ“ (åœ†)',
  'close': 'âœ•',
  'home': 'ğŸ ',
  'user': 'ğŸ‘¤',
  'comment': 'ğŸ’¬',
  'share': 'ğŸ“¤',
  'calendar': 'ğŸ“…',
  'clock': 'ğŸ•',
  'delete': 'ğŸ—‘ï¸',
  'edit': 'âœï¸',
  'menu': 'â˜°',
  'search': 'ğŸ”',
  'back': 'â†',
  'forward': 'â†’',
  'up': 'â†‘',
  'down': 'â†“'
};
```

---

# 4 ä¸šåŠ¡ç»„ä»¶

## 4.1 è¯¾ç¨‹å¡ç‰‡ - CourseCard

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-course-card
  title="{{course.title}}"
  days="{{course.total_days}}"
  progress="{{course.progress}}"
  status="{{course.status}}"
  startDate="{{course.start_date}}"
  endDate="{{course.end_date}}"
  checkinCount="{{course.checkin_count}}"
  bind:tap="handleCourseClick"
/>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    title: String,        // è¯¾ç¨‹æ ‡é¢˜
    days: Number,         // æ€»å¤©æ•°
    progress: {
      type: Number,
      value: 0            // è¿›åº¦ç™¾åˆ†æ¯” 0-100
    },
    status: {
      type: String,
      value: 'ongoing'
      // ongoing, completed, upcoming
    },
    startDate: String,    // YYYY-MM-DD
    endDate: String,      // YYYY-MM-DD
    checkinCount: Number, // æ‰“å¡äººæ•°
    image: String         // è¯¾ç¨‹èƒŒæ™¯å›¾
  }
});
```

### æ ·å¼å®ç°

```wxss
.v-course-card {
  border-radius: var(--radius-lg);
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: var(--spacing-lg);
  margin-bottom: var(--spacing-lg);
  box-shadow: var(--shadow-md);
  overflow: hidden;
}

.course-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-bold);
  margin-bottom: var(--spacing-md);
}

.course-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-md);
  font-size: var(--font-size-sm);
}

.progress-bar {
  height: 6px;
  background: rgba(255, 255, 255, 0.3);
  border-radius: var(--radius-full);
  overflow: hidden;
  margin-bottom: var(--spacing-md);
}

.progress-fill {
  height: 100%;
  background: white;
  transition: width 0.3s ease;
}

.course-footer {
  display: flex;
  justify-content: space-between;
  font-size: var(--font-size-sm);
  opacity: 0.9;
}
```

## 4.2 æ‰“å¡å¡ç‰‡ - CheckinCard

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-checkin-card
  status="{{checkinStatus}}"
  checkinTime="{{lastCheckinTime}}"
  streak="{{consecutiveDays}}"
  todayTask="{{todayTask}}"
  bind:checkin="handleCheckin"
/>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    status: {
      type: String,
      value: 'unchecked'
      // unchecked, checked, missed
    },
    checkinTime: String,   // HH:mm
    streak: Number,        // è¿ç»­æ‰“å¡å¤©æ•°
    todayTask: String,     // ä»Šæ—¥ä»»åŠ¡æè¿°
    motivational: String   // æ¿€åŠ±æ–‡æ¡ˆ
  }
});
```

## 4.3 è¯„è®ºé¡¹ - CommentItem

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-comment-item
  userId="{{comment.user_id}}"
  userName="{{comment.user_name}}"
  userAvatar="{{comment.avatar_url}}"
  content="{{comment.content}}"
  timestamp="{{comment.created_at}}"
  likeCount="{{comment.like_count}}"
  isLiked="{{comment.is_liked}}"
  replyCount="{{comment.reply_count}}"
  bind:like="handleLike"
  bind:reply="handleReply"
  bind:userTap="handleUserTap"
/>
```

### ç»„ä»¶å±æ€§

```javascript
Component({
  properties: {
    userId: String,
    userName: String,
    userAvatar: String,
    content: String,
    timestamp: String,        // ISO 8601 æ ¼å¼
    likeCount: {
      type: Number,
      value: 0
    },
    isLiked: Boolean,
    replyCount: {
      type: Number,
      value: 0
    },
    isReply: Boolean,          // æ˜¯å¦æ˜¯å›å¤
    parentUserName: String     // è¢«å›å¤è€…åå­—
  }
});
```

## 4.4 ç”¨æˆ·ä¿¡æ¯å¡ - UserProfile

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-user-profile
  nickname="{{user.nickname}}"
  avatar="{{user.avatar_url}}"
  level="{{user.level}}"
  totalCheckins="{{user.total_checkins}}"
  currentStreak="{{user.current_streak}}"
  joinDate="{{user.created_at}}"
  edit-mode="{{isEditMode}}"
  bind:edit="handleEdit"
/>
```

## 4.5 åé¦ˆå¡ - InsightCard

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-insight-card
  title="{{insight.title}}"
  content="{{insight.content}}"
  tags="{{insight.tags}}"
  date="{{insight.created_at}}"
  bind:share="handleShare"
  bind:read-more="handleReadMore"
/>
```

## 4.6 åˆ†äº«å¡ç‰‡ - ShareCard

### ä½¿ç”¨ç¤ºä¾‹

```wxml
<v-share-card
  title="{{shareData.title}}"
  description="{{shareData.description}}"
  image="{{shareData.image}}"
  checkinDays="{{checkingDays}}"
  motivationalText="{{motivationalText}}"
/>
```

---

# 5 é¡µé¢æ¨¡æ¿

## 5.1 é¦–é¡µæ¨¡æ¿

```wxml
<!-- pages/index/index.wxml -->
<view class="page-index">
  <!-- é¡¶éƒ¨Banner -->
  <view class="banner">
    <text class="banner-text">{{dailyMotivation}}</text>
  </view>

  <!-- è¯¾ç¨‹åˆ—è¡¨ -->
  <view class="courses-section">
    <view class="section-title">
      <text>æˆ‘çš„è¯¾ç¨‹</text>
      <view bind:tap="handleRefresh" class="refresh-btn">
        <v-icon name="refresh" size="20" />
      </view>
    </view>
    
    <view class="courses-list" scroll-y="true">
      <v-course-card 
        wx:for="{{courses}}" 
        wx:key="id"
        title="{{item.title}}"
        days="{{item.total_days}}"
        progress="{{item.progress}}"
        status="{{item.status}}"
        bind:tap="handleCourseClick"
        data-course-id="{{item.id}}"
      />
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <v-loading type="spinner" text="åŠ è½½ä¸­..." />
  </view>
</view>
```

### é¡µé¢é€»è¾‘

```javascript
// pages/index/index.js
Page({
  data: {
    courses: [],
    loading: true,
    dailyMotivation: '',
    refreshing: false
  },

  onLoad() {
    this.fetchCourses();
    this.fetchMotivation();
  },

  onPullDownRefresh() {
    this.setData({ refreshing: true });
    this.fetchCourses().then(() => {
      wx.stopPullDownRefresh();
      this.setData({ refreshing: false });
    });
  },

  fetchCourses() {
    return wx.request({
      url: '/api/v1/courses',
      method: 'GET',
      data: {
        page: 1,
        limit: 10
      },
      success: (res) => {
        if (res.statusCode === 200) {
          this.setData({
            courses: res.data.data.items,
            loading: false
          });
        }
      },
      fail: (err) => {
        console.error('è·å–è¯¾ç¨‹åˆ—è¡¨å¤±è´¥:', err);
        wx.showToast({ title: 'åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•', icon: 'none' });
      }
    });
  },

  fetchMotivation() {
    // è°ƒç”¨åç«¯APIè·å–æ¯æ—¥æ¿€åŠ±æ–‡æ¡ˆ
  },

  handleCourseClick(e) {
    const courseId = e.currentTarget.dataset.courseId;
    wx.navigateTo({
      url: `/pages/course-detail/index?id=${courseId}`
    });
  },

  handleRefresh() {
    this.fetchCourses();
  }
});
```

## 5.2 æ‰“å¡é¡µé¢æ¨¡æ¿

```wxml
<!-- pages/checkin/index.wxml -->
<view class="page-checkin">
  <!-- æ‰“å¡å¡ç‰‡ -->
  <v-checkin-card
    status="{{checkinStatus}}"
    checkinTime="{{lastCheckinTime}}"
    streak="{{consecutiveDays}}"
    todayTask="{{todayTask}}"
    bind:checkin="handleCheckin"
  />

  <!-- å­¦ä¹ ç»Ÿè®¡ -->
  <view class="statistics-section">
    <view class="stat-item">
      <text class="stat-label">æ€»æ‰“å¡</text>
      <text class="stat-value">{{totalCheckins}}</text>
    </view>
    <view class="stat-item">
      <text class="stat-label">è¿ç»­æ‰“å¡</text>
      <text class="stat-value">{{currentStreak}}å¤©</text>
    </view>
    <view class="stat-item">
      <text class="stat-label">å®Œæˆç‡</text>
      <text class="stat-value">{{completionRate}}%</text>
    </view>
  </view>

  <!-- åé¦ˆåŒºåŸŸ -->
  <view class="insight-section" wx:if="{{latestInsight}}">
    <text class="section-title">å°å‡¡çœ‹è§</text>
    <v-insight-card
      title="{{latestInsight.title}}"
      content="{{latestInsight.content}}"
      tags="{{latestInsight.tags}}"
      date="{{latestInsight.created_at}}"
      bind:share="handleShareInsight"
    />
  </view>

  <!-- æ‰“å¡æŒ‰é’® -->
  <view class="action-buttons">
    <v-button
      type="primary"
      size="large"
      loading="{{submitting}}"
      bind:click="handleSubmitCheckin"
      wx:if="{{checkinStatus === 'unchecked'}}"
    >
      ç¡®è®¤æ‰“å¡
    </v-button>
    <v-button
      type="secondary"
      size="large"
      disabled="true"
      wx:else
    >
      å·²æ‰“å¡
    </v-button>
  </view>
</view>
```

### é¡µé¢é€»è¾‘

```javascript
// pages/checkin/index.js
Page({
  data: {
    checkinStatus: 'unchecked',  // unchecked, checked
    lastCheckinTime: '',
    consecutiveDays: 0,
    totalCheckins: 0,
    currentStreak: 0,
    todayTask: '',
    latestInsight: null,
    completionRate: 0,
    submitting: false
  },

  onLoad() {
    this.loadCheckinData();
  },

  loadCheckinData() {
    // è·å–æ‰“å¡æ•°æ®
    wx.request({
      url: '/api/v1/checkins/today',
      success: (res) => {
        if (res.statusCode === 200) {
          const data = res.data.data;
          this.setData({
            checkinStatus: data.status,
            lastCheckinTime: data.last_checkin_time,
            consecutiveDays: data.consecutive_days,
            totalCheckins: data.total_checkins,
            currentStreak: data.current_streak,
            completionRate: data.completion_rate,
            latestInsight: data.latest_insight
          });
        }
      }
    });
  },

  handleSubmitCheckin() {
    this.setData({ submitting: true });
    wx.request({
      url: '/api/v1/checkins',
      method: 'POST',
      data: {
        course_id: this.data.courseId,
        section_id: this.data.sectionId,
        diary_content: this.data.diaryContent || ''
      },
      success: (res) => {
        if (res.statusCode === 201) {
          wx.showToast({
            title: 'æ‰“å¡æˆåŠŸï¼',
            icon: 'success',
            duration: 2000
          });
          this.setData({
            checkinStatus: 'checked',
            submitting: false
          });
          // åˆ·æ–°æ•°æ®
          setTimeout(() => this.loadCheckinData(), 1000);
        }
      },
      fail: (err) => {
        wx.showToast({ title: 'æ‰“å¡å¤±è´¥ï¼Œè¯·é‡è¯•', icon: 'none' });
        this.setData({ submitting: false });
      }
    });
  },

  handleShareInsight() {
    wx.shareAppMessage({
      title: this.data.latestInsight.title,
      path: `/pages/share/index?insightId=${this.data.latestInsight.id}`,
      imageUrl: '/static/share-default.png'
    });
  }
});
```

---

# 6 å·¥å…·å‡½æ•°åº“

## 6.1 è¯·æ±‚å·¥å…· - request.js

```javascript
// utils/request.js
class HttpRequest {
  constructor() {
    this.baseURL = 'https://api.morning-reading.com/api/v1';
    this.timeout = 10000;
  }

  // GET è¯·æ±‚
  get(url, params = {}) {
    return this.request({
      url,
      method: 'GET',
      data: params
    });
  }

  // POST è¯·æ±‚
  post(url, data = {}) {
    return this.request({
      url,
      method: 'POST',
      data
    });
  }

  // PUT è¯·æ±‚
  put(url, data = {}) {
    return this.request({
      url,
      method: 'PUT',
      data
    });
  }

  // DELETE è¯·æ±‚
  delete(url) {
    return this.request({
      url,
      method: 'DELETE'
    });
  }

  // æ ¸å¿ƒè¯·æ±‚æ–¹æ³•
  request(options) {
    const { url, method = 'GET', data = {} } = options;
    const token = wx.getStorageSync('token');
    
    return new Promise((resolve, reject) => {
      wx.request({
        url: `${this.baseURL}${url}`,
        method,
        data,
        header: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        timeout: this.timeout,
        success: (res) => {
          if (res.statusCode === 200 || res.statusCode === 201) {
            resolve(res.data);
          } else if (res.statusCode === 401) {
            // Tokenè¿‡æœŸï¼Œé‡æ–°ç™»å½•
            this.handleAuthError();
            reject(new Error('è®¤è¯å¤±è´¥'));
          } else {
            reject(new Error(res.data.message || 'è¯·æ±‚å¤±è´¥'));
          }
        },
        fail: (err) => {
          console.error('ç½‘ç»œè¯·æ±‚å¤±è´¥:', err);
          reject(err);
        }
      });
    });
  }

  handleAuthError() {
    wx.removeStorageSync('token');
    wx.redirectTo({ url: '/pages/login/index' });
  }
}

module.exports = new HttpRequest();
```

## 6.2 æ ¼å¼åŒ–å·¥å…· - formatters.js

```javascript
// utils/formatters.js
module.exports = {
  // æ ¼å¼åŒ–æ—¥æœŸ
  formatDate(date, format = 'YYYY-MM-DD') {
    const d = new Date(date);
    const year = d.getFullYear();
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const day = String(d.getDate()).padStart(2, '0');
    
    return `${year}-${month}-${day}`;
  },

  // æ ¼å¼åŒ–æ—¶é—´å·®
  formatTimeAgo(timestamp) {
    const now = Date.now();
    const diff = Math.floor((now - new Date(timestamp).getTime()) / 1000);
    
    if (diff < 60) return 'åˆšåˆš';
    if (diff < 3600) return `${Math.floor(diff / 60)}åˆ†é’Ÿå‰`;
    if (diff < 86400) return `${Math.floor(diff / 3600)}å°æ—¶å‰`;
    if (diff < 2592000) return `${Math.floor(diff / 86400)}å¤©å‰`;
    
    return this.formatDate(timestamp);
  },

  // æ ¼å¼åŒ–æ•°å­—
  formatNumber(num) {
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
    return num.toString();
  },

  // æˆªæ–­æ–‡æœ¬
  truncateText(text, length = 50) {
    if (text.length > length) {
      return text.substring(0, length) + '...';
    }
    return text;
  }
};
```

## 6.3 éªŒè¯å·¥å…· - validators.js

```javascript
// utils/validators.js
module.exports = {
  // éªŒè¯é‚®ç®±
  isEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
  },

  // éªŒè¯æ‰‹æœºå·
  isPhone(phone) {
    const regex = /^1[3-9]\d{9}$/;
    return regex.test(phone);
  },

  // éªŒè¯éç©º
  isEmpty(value) {
    return value === null || value === undefined || value === '';
  },

  // éªŒè¯é•¿åº¦
  isValidLength(value, min = 0, max = 255) {
    return value.length >= min && value.length <= max;
  },

  // éªŒè¯URL
  isUrl(url) {
    try {
      new URL(url);
      return true;
    } catch {
      return false;
    }
  }
};
```

## 6.4 å­˜å‚¨å·¥å…· - storage.js

```javascript
// utils/storage.js
class Storage {
  // è®¾ç½®å­˜å‚¨
  set(key, value, expire = null) {
    const data = {
      value,
      timestamp: Date.now(),
      expire
    };
    wx.setStorageSync(key, JSON.stringify(data));
  }

  // è·å–å­˜å‚¨
  get(key) {
    try {
      const data = JSON.parse(wx.getStorageSync(key));
      
      if (!data) return null;
      
      // æ£€æŸ¥è¿‡æœŸæ—¶é—´
      if (data.expire) {
        const now = Date.now();
        if (now - data.timestamp > data.expire) {
          this.remove(key);
          return null;
        }
      }
      
      return data.value;
    } catch {
      return null;
    }
  }

  // åˆ é™¤å­˜å‚¨
  remove(key) {
    wx.removeStorageSync(key);
  }

  // æ¸…ç©ºå­˜å‚¨
  clear() {
    wx.clearStorageSync();
  }

  // è·å–æ‰€æœ‰é”®
  getAllKeys() {
    const info = wx.getStorageInfoSync();
    return info.keys || [];
  }
}

module.exports = new Storage();
```

---

# 7 æ ·å¼å˜é‡ä¸ä¸»é¢˜

## 7.1 å…¨å±€å˜é‡æ–‡ä»¶

```wxss
/* styles/variables.wxss */

/* ================== é¢œè‰²ç³»ç»Ÿ ================== */
page {
  /* ä¸»è‰²ç³» */
  --color-primary: #FF6B6B;
  --color-primary-light: #FFE5E5;
  --color-primary-dark: #CC5555;

  /* è¾…åŠ©è‰² */
  --color-success: #51CF66;
  --color-warning: #FFD93D;
  --color-error: #FF6B6B;
  --color-info: #4ECDC4;

  /* ä¸­ç«‹è‰² */
  --color-text-primary: #1F2937;
  --color-text-secondary: #6B7280;
  --color-text-tertiary: #9CA3AF;
  --color-border: #E5E7EB;
  --color-bg-primary: #FFFFFF;
  --color-bg-secondary: #F9FAFB;
  --color-bg-tertiary: #F3F4F6;
  --color-overlay: rgba(0, 0, 0, 0.5);

  /* ================== å­—ä½“ç³»ç»Ÿ ================== */
  --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  
  --font-size-xs: 24rpx;
  --font-size-sm: 26rpx;
  --font-size-base: 28rpx;
  --font-size-lg: 32rpx;
  --font-size-xl: 36rpx;
  --font-size-2xl: 40rpx;

  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;

  /* ================== é—´è·ç³»ç»Ÿ ================== */
  --spacing-xs: 4rpx;
  --spacing-sm: 8rpx;
  --spacing-md: 12rpx;
  --spacing-lg: 16rpx;
  --spacing-xl: 24rpx;
  --spacing-2xl: 32rpx;
  --spacing-3xl: 48rpx;

  /* ================== åœ†è§’ç³»ç»Ÿ ================== */
  --radius-sm: 4rpx;
  --radius-md: 8rpx;
  --radius-lg: 12rpx;
  --radius-xl: 16rpx;
  --radius-full: 9999rpx;

  /* ================== é˜´å½±ç³»ç»Ÿ ================== */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.15);
  --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.2);

  /* ================== è¿‡æ¸¡æ•ˆæœ ================== */
  --transition-fast: 0.15s ease;
  --transition-base: 0.3s ease;
  --transition-slow: 0.5s ease;
}
```

## 7.2 é€šç”¨æ ·å¼

```wxss
/* styles/common.wxss */

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

page {
  background-color: var(--color-bg-secondary);
  font-family: var(--font-family);
  font-size: var(--font-size-base);
  color: var(--color-text-primary);
}

view {
  display: block;
}

text {
  display: inline;
  word-wrap: break-word;
  word-break: break-all;
}

/* æ–‡æœ¬å·¥å…·ç±» */
.text-primary {
  color: var(--color-text-primary);
}

.text-secondary {
  color: var(--color-text-secondary);
}

.text-tertiary {
  color: var(--color-text-tertiary);
}

/* é—´è·å·¥å…·ç±» */
.mt-md { margin-top: var(--spacing-md); }
.mb-md { margin-bottom: var(--spacing-md); }
.mx-lg { margin-left: var(--spacing-lg); margin-right: var(--spacing-lg); }

.p-md { padding: var(--spacing-md); }
.px-lg { padding-left: var(--spacing-lg); padding-right: var(--spacing-lg); }
.py-md { padding-top: var(--spacing-md); padding-bottom: var(--spacing-md); }

/* Flexbox å·¥å…·ç±» */
.flex {
  display: flex;
}

.flex-column {
  display: flex;
  flex-direction: column;
}

.flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* å“åº”å¼ */
.hidden {
  display: none;
}

.visible {
  display: block;
}
```

## 7.3 åŠ¨ç”»ç³»ç»Ÿ

```wxss
/* styles/animations.wxss */

/* æ·¡å…¥æ·¡å‡º */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease forwards;
}

/* æ»‘å…¥æ»‘å‡º */
@keyframes slideInUp {
  from {
    transform: translateY(30px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideOutDown {
  from {
    transform: translateY(0);
    opacity: 1;
  }
  to {
    transform: translateY(30px);
    opacity: 0;
  }
}

.animate-slide-in-up {
  animation: slideInUp 0.3s ease forwards;
}

/* ç¼©æ”¾ */
@keyframes scaleIn {
  from {
    transform: scale(0.9);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.animate-scale-in {
  animation: scaleIn 0.3s ease forwards;
}

/* æ—‹è½¬åŠ è½½ */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* è„‰å†² */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.animate-pulse {
  animation: pulse 2s ease-in-out infinite;
}
```

---

# 8 ç»„ä»¶å¼€å‘è§„èŒƒ

## 8.1 å‘½åè§„èŒƒ

```javascript
// ç»„ä»¶å‘½åè§„èŒƒ
components/
â”œâ”€â”€ v-button/          // å°é©¼å³° + vå‰ç¼€ï¼ˆvendorï¼‰
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ index.wxml
â”‚   â”œâ”€â”€ index.wxss
â”‚   â””â”€â”€ index.json
â”œâ”€â”€ v-course-card/
â”‚   â””â”€â”€ ...
```

## 8.2 ç»„ä»¶ç»“æ„æ¨¡æ¿

```javascript
// components/example/index.js
Component({
  // ç»„ä»¶å±æ€§å®šä¹‰
  properties: {
    title: {
      type: String,
      value: '',
      observer(newVal, oldVal) {
        // å±æ€§å˜åŒ–ç›‘å¬
      }
    }
  },

  // ç»„ä»¶æ•°æ®
  data: {
    internalState: false
  },

  // è®¡ç®—å±æ€§ï¼ˆComputedï¼‰
  observers: {
    'properties.title': function(newVal) {
      // ä¾èµ–å±æ€§å˜åŒ–æ—¶è§¦å‘
    }
  },

  // ç»„ä»¶æ–¹æ³•
  methods: {
    handleTap() {
      this.triggerEvent('tap', { data: 'value' });
    }
  },

  // ç”Ÿå‘½å‘¨æœŸ
  lifetimes: {
    attached() {
      // ç»„ä»¶æŒ‚è½½æ—¶
    },
    detached() {
      // ç»„ä»¶å¸è½½æ—¶
    }
  }
});
```

```wxml
<!-- components/example/index.wxml -->
<view class="v-example {{customClass}}" bind:tap="handleTap">
  <text>{{title}}</text>
</view>
```

```wxss
/* components/example/index.wxss */
.v-example {
  padding: var(--spacing-md);
  border-radius: var(--radius-md);
  background-color: var(--color-bg-primary);
  transition: all var(--transition-base);
}

.v-example:active {
  opacity: 0.8;
}
```

```json
{
  "component": true,
  "usingComponents": {}
}
```

## 8.3 äº‹ä»¶è§„èŒƒ

```javascript
// ç»„ä»¶äº‹ä»¶å‘½åè§„èŒƒ
this.triggerEvent('eventName', detail, options);

// ä¾‹å¦‚ï¼š
this.triggerEvent('checkin', { 
  checkinId: '123',
  timestamp: Date.now()
}, {
  bubbles: true,
  composed: true
});
```

---

# 9 æ€§èƒ½ä¼˜åŒ–æŒ‡å—

## 9.1 åˆ—è¡¨ä¼˜åŒ–

```wxml
<!-- ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨å¤„ç†å¤§æ•°æ® -->
<scroll-view
  scroll-y
  scroll-into-view="{{scrollIntoView}}"
  scroll-top="{{scrollTop}}"
  bind:scroll="handleScroll"
  bind:scrolltolower="handleLoadMore"
  lower-threshold="100"
>
  <view wx:for="{{items}}" wx:key="id" class="item">
    <!-- å†…å®¹ -->
  </view>
</scroll-view>
```

## 9.2 å›¾ç‰‡ä¼˜åŒ–

```wxml
<!-- ä½¿ç”¨ mode="widthFix" ä¼˜åŒ–æ¸²æŸ“ -->
<image
  src="{{imageUrl}}"
  mode="widthFix"
  lazy-load="true"
  show-menu-by-longpress="true"
/>
```

## 9.3 ç¼“å­˜ç­–ç•¥

```javascript
// ç¼“å­˜APIå“åº”
const cacheKey = `api_${url}_${JSON.stringify(params)}`;
const cached = storage.get(cacheKey);

if (cached) {
  return Promise.resolve(cached);
}

return request.get(url, params).then(data => {
  storage.set(cacheKey, data, 3600000); // 1å°æ—¶è¿‡æœŸ
  return data;
});
```

## 9.4 é˜²æŠ–å’ŒèŠ‚æµ

```javascript
// é˜²æŠ–å‡½æ•°
function debounce(fn, delay = 300) {
  let timer = null;
  return function(...args) {
    clearTimeout(timer);
    timer = setTimeout(() => fn.apply(this, args), delay);
  };
}

// èŠ‚æµå‡½æ•°
function throttle(fn, delay = 300) {
  let lastTime = 0;
  return function(...args) {
    const now = Date.now();
    if (now - lastTime >= delay) {
      fn.apply(this, args);
      lastTime = now;
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹
Page({
  methods: {
    handleSearch: debounce(function(e) {
      // æœç´¢æ“ä½œ
    }, 500),

    handleScroll: throttle(function(e) {
      // æ»šåŠ¨å¤„ç†
    }, 200)
  }
});
```

---

## é™„å½•ï¼šç›®å½•ç»“æ„å‚è€ƒ

```
miniapp/
â”œâ”€â”€ app.js                      # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ app.wxss                    # å…¨å±€æ ·å¼
â”œâ”€â”€ app.json                    # åº”ç”¨é…ç½®
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ base/                   # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ v-button/
â”‚   â”‚   â”œâ”€â”€ v-input/
â”‚   â”‚   â”œâ”€â”€ v-image/
â”‚   â”‚   â””â”€â”€ v-loading/
â”‚   â”œâ”€â”€ business/               # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ v-course-card/
â”‚   â”‚   â”œâ”€â”€ v-checkin-card/
â”‚   â”‚   â”œâ”€â”€ v-comment-item/
â”‚   â”‚   â”œâ”€â”€ v-user-profile/
â”‚   â”‚   â”œâ”€â”€ v-insight-card/
â”‚   â”‚   â””â”€â”€ v-share-card/
â”‚   â””â”€â”€ layout/                 # å¸ƒå±€ç»„ä»¶
â”‚       â”œâ”€â”€ v-navbar/
â”‚       â”œâ”€â”€ v-tabbar/
â”‚       â””â”€â”€ v-modal/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ index/                  # é¦–é¡µ
â”‚   â”œâ”€â”€ courses/                # è¯¾ç¨‹åˆ—è¡¨
â”‚   â”œâ”€â”€ course-detail/          # è¯¾ç¨‹è¯¦æƒ…
â”‚   â”œâ”€â”€ checkin/                # æ‰“å¡é¡µé¢
â”‚   â”œâ”€â”€ profile/                # ä¸ªäººä¸»é¡µ
â”‚   â””â”€â”€ login/                  # ç™»å½•é¡µé¢
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ request.js
â”‚   â”œâ”€â”€ formatters.js
â”‚   â”œâ”€â”€ validators.js
â”‚   â””â”€â”€ storage.js
â””â”€â”€ styles/
    â”œâ”€â”€ variables.wxss
    â”œâ”€â”€ common.wxss
    â””â”€â”€ animations.wxss
```

