# æµ‹è¯•ä¸éªŒè¯æœºåˆ¶å®æ–½æ€»ç»“

**åˆ›å»ºæ—¥æœŸ**: 2025-12-17
**çŠ¶æ€**: è®¾è®¡å®Œæˆï¼Œå¾…å®æ–½

---

## ğŸ“‹ å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£            | è·¯å¾„                         | ç”¨é€”                                 |
| --------------- | ---------------------------- | ------------------------------------ |
| å®Œæ•´æµ‹è¯•ç­–ç•¥    | `TESTING_STRATEGY.md`        | è¯¦ç»†çš„æµ‹è¯•é‡‘å­—å¡”ã€è§¦å‘è§„åˆ™ã€å·¥å…·é€‰æ‹© |
| å¿«é€Ÿå¯åŠ¨æŒ‡å—    | `TESTING_QUICKSTART.md`      | 30åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹æµ‹è¯•ç³»ç»Ÿ               |
| Packageæ›´æ–°å»ºè®® | `TESTING_PACKAGE_UPDATES.md` | æ‰€éœ€ä¾èµ–å’Œè„šæœ¬é…ç½®                   |

### 2. é…ç½®æ–‡ä»¶

| æ–‡ä»¶           | è·¯å¾„                                       | è¯´æ˜                |
| -------------- | ------------------------------------------ | ------------------- |
| Vitesté…ç½®     | `admin/vitest.config.ts`                   | Adminå•å…ƒæµ‹è¯•é…ç½®   |
| Vitestæµ‹è¯•è®¾ç½® | `admin/src/tests/setup.ts`                 | å…¨å±€æµ‹è¯•ç¯å¢ƒé…ç½®    |
| ç¤ºä¾‹æµ‹è¯•       | `admin/src/services/__tests__/api.spec.ts` | API Serviceæµ‹è¯•ç¤ºä¾‹ |

### 3. Git Hooks

| æ–‡ä»¶             | è·¯å¾„                                | åŠŸèƒ½                         |
| ---------------- | ----------------------------------- | ---------------------------- |
| Pre-commitå¢å¼ºç‰ˆ | `scripts/hooks/pre-commit-enhanced` | ESLint + Prettier + å•å…ƒæµ‹è¯• |
| Pre-push         | `scripts/hooks/pre-push`            | å®Œæ•´æµ‹è¯• + æ„å»ºéªŒè¯          |
| å®‰è£…è„šæœ¬         | `scripts/install-test-hooks.sh`     | ä¸€é”®å®‰è£…hooks                |

### 4. CI/CD é…ç½®

| æ–‡ä»¶     | è·¯å¾„                              | è§¦å‘æ—¶æœº      |
| -------- | --------------------------------- | ------------- |
| CIä¸»æµç¨‹ | `.github/workflows/ci.yml`        | æ¯æ¬¡pushã€PR  |
| å®šæœŸä»»åŠ¡ | `.github/workflows/scheduled.yml` | æ¯å¤©02:00 UTC |

### 5. è¾…åŠ©è„šæœ¬

| æ–‡ä»¶         | è·¯å¾„                         | ç”¨é€”              |
| ------------ | ---------------------------- | ----------------- |
| æµ‹è¯•ä¿®å¤è„šæœ¬ | `scripts/fix-mocha-tests.sh` | ä¿®å¤beforeAllé—®é¢˜ |

---

## ğŸ¯ æµ‹è¯•ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
                    æµ‹è¯•é‡‘å­—å¡”
                       /\
                      /  \     E2E Tests (5%)
                     /----\    - Cypress (Admin)
                    /      \   - APIå¥‘çº¦æµ‹è¯•
                   /--------\
                  /          \ Integration Tests (25%)
                 /            \ - Backend APIæµç¨‹
                /              \ - æ•°æ®åº“äº¤äº’
               /________________\
              /                  \ Unit Tests (70%)
             /                    \ - Controllers/Models/Utils
            /______________________\ - Components/Services
```

### è§¦å‘æœºåˆ¶

```
å¼€å‘æµç¨‹: æœ¬åœ°å¼€å‘ â†’ Pre-commit â†’ Commit â†’ Pre-push â†’ Push â†’ CI/CD

Pre-commit (3åˆ†é’Ÿ):
  â”œâ”€ ESLint æ£€æŸ¥
  â”œâ”€ Prettier æ ¼å¼æ£€æŸ¥
  â”œâ”€ æ•æ„Ÿæ–‡ä»¶æ£€æŸ¥
  â”œâ”€ Debugger/Console æ£€æŸ¥
  â””â”€ å¿«é€Ÿå•å…ƒæµ‹è¯•

Pre-push (6åˆ†é’Ÿ):
  â”œâ”€ æ‰€æœ‰å•å…ƒæµ‹è¯•
  â”œâ”€ é›†æˆæµ‹è¯•
  â””â”€ æ„å»ºæµ‹è¯•

CI (10-15åˆ†é’Ÿ):
  â”œâ”€ Lint (å¹¶è¡Œ)
  â”œâ”€ å•å…ƒæµ‹è¯• (å¹¶è¡Œ)
  â”œâ”€ é›†æˆæµ‹è¯•
  â”œâ”€ E2Eæµ‹è¯• (ä»…PR)
  â”œâ”€ å®‰å…¨æ‰«æ
  â””â”€ æ„å»ºæµ‹è¯•
```

---

## ğŸ“¦ æ‰€éœ€ä¾èµ–æ±‡æ€»

### Backend æ–°å¢ä¾èµ–

```json
{
  "devDependencies": {
    "artillery": "^2.0.0",
    "newman": "^6.0.0",
    "@faker-js/faker": "^8.3.1",
    "nock": "^13.5.0"
  }
}
```

### Admin æ–°å¢ä¾èµ–

```json
{
  "devDependencies": {
    "vitest": "^1.0.0",
    "@vue/test-utils": "^2.4.0",
    "@vitest/ui": "^1.0.0",
    "c8": "^9.0.0",
    "happy-dom": "^12.0.0",
    "@cypress/vue": "^6.0.0"
  }
}
```

**ä¼°ç®—æˆæœ¬**: ~50MB é¢å¤–å­˜å‚¨ç©ºé—´

---

## ğŸš€ å®æ–½æ­¥éª¤

### é˜¶æ®µ1: ä¿®å¤ç°æœ‰æµ‹è¯•ï¼ˆP0 - ç«‹å³æ‰§è¡Œï¼‰

**æ—¶é—´**: 1-2å¤©

```bash
# 1. ä¿®å¤Backendé›†æˆæµ‹è¯•
./scripts/fix-mocha-tests.sh

# 2. éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡
cd backend
npm run test:unit
npm run test:integration

# 3. ç¡®ä¿è¦†ç›–ç‡è¾¾æ ‡
npm run test:coverage
# ç›®æ ‡: è¡Œè¦†ç›–ç‡ 70%+
```

**éªŒæ”¶æ ‡å‡†**:

- [x] æ‰€æœ‰Backendå•å…ƒæµ‹è¯•é€šè¿‡
- [x] æ‰€æœ‰Backendé›†æˆæµ‹è¯•é€šè¿‡
- [x] è¦†ç›–ç‡ â‰¥ 70%

### é˜¶æ®µ2: é…ç½®Git Hooksï¼ˆP0 - ç«‹å³æ‰§è¡Œï¼‰

**æ—¶é—´**: åŠå¤©

```bash
# 1. å®‰è£…å¢å¼ºç‰ˆhooks
./scripts/install-test-hooks.sh

# 2. æµ‹è¯•pre-commit
git add .
git commit -m "test: æµ‹è¯•hooks"

# 3. æµ‹è¯•pre-push
git push origin test-branch

# 4. éªŒè¯æ‰€æœ‰æ£€æŸ¥æ‰§è¡Œ
```

**éªŒæ”¶æ ‡å‡†**:

- [x] Pre-commit hookæ­£å¸¸è¿è¡Œ
- [x] Pre-push hookæ­£å¸¸è¿è¡Œ
- [x] é”™è¯¯ä¿¡æ¯æ¸…æ™°æ˜äº†
- [x] åé¦ˆæ—¶é—´ â‰¤ 5åˆ†é’Ÿ

### é˜¶æ®µ3: æ·»åŠ Adminå•å…ƒæµ‹è¯•ï¼ˆP1 - é«˜ä¼˜å…ˆçº§ï¼‰

**æ—¶é—´**: 2-3å¤©

```bash
# 1. å®‰è£…ä¾èµ–
cd admin
npm install --save-dev vitest @vue/test-utils @vitest/ui c8 happy-dom

# 2. åˆ›å»ºæµ‹è¯•é…ç½®
# - vitest.config.tsï¼ˆå·²æœ‰ï¼‰
# - src/tests/setup.tsï¼ˆå·²æœ‰ï¼‰

# 3. ç¼–å†™ç»„ä»¶æµ‹è¯•
# - å…ˆæµ‹è¯•å·¥å…·å‡½æ•°
# - å†æµ‹è¯•å…¬å…±ç»„ä»¶
# - æœ€åæµ‹è¯•é¡µé¢ç»„ä»¶

# 4. è¿è¡Œæµ‹è¯•
npm run test:unit

# 5. æ£€æŸ¥è¦†ç›–ç‡
npm run test:coverage
# ç›®æ ‡: 60%+
```

**éªŒæ”¶æ ‡å‡†**:

- [x] Vitesté…ç½®å®Œæˆ
- [x] è‡³å°‘5ä¸ªç»„ä»¶æœ‰æµ‹è¯•
- [x] è¦†ç›–ç‡ â‰¥ 60%
- [x] æ‰€æœ‰æµ‹è¯•é€šè¿‡

### é˜¶æ®µ4: é…ç½®CI/CDï¼ˆP1 - é«˜ä¼˜å…ˆçº§ï¼‰

**æ—¶é—´**: 1å¤©

```bash
# 1. åˆ›å»ºGitHub Actionsé…ç½®
# - .github/workflows/ci.ymlï¼ˆå·²æœ‰ï¼‰
# - .github/workflows/scheduled.ymlï¼ˆå·²æœ‰ï¼‰

# 2. é…ç½®Secrets
# GitHubä»“åº“è®¾ç½® â†’ Secrets â†’ Actions:
# - CODECOV_TOKENï¼ˆå¯é€‰ï¼‰
# - SNYK_TOKENï¼ˆå¯é€‰ï¼‰
# - SLACK_WEBHOOKï¼ˆå¯é€‰ï¼‰

# 3. æäº¤æµ‹è¯•PR
git checkout -b test-ci
git push origin test-ci
# åˆ›å»ºPRåˆ°main

# 4. éªŒè¯CIæµç¨‹
# - æŸ¥çœ‹GitHub Actionsé¡µé¢
# - ç¡®è®¤æ‰€æœ‰jobé€šè¿‡
# - æ£€æŸ¥åé¦ˆæ—¶é—´
```

**éªŒæ”¶æ ‡å‡†**:

- [x] CIæˆåŠŸè¿è¡Œæ‰€æœ‰job
- [x] PRåˆå¹¶å‰é˜»æ­¢å¤±è´¥
- [x] åé¦ˆæ—¶é—´ â‰¤ 15åˆ†é’Ÿ
- [x] è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆ

### é˜¶æ®µ5: æ·»åŠ E2Eæµ‹è¯•ï¼ˆP2 - ä¸­ä¼˜å…ˆçº§ï¼‰

**æ—¶é—´**: 2-3å¤©

```bash
# 1. é…ç½®Cypressï¼ˆå·²æœ‰åŸºç¡€é…ç½®ï¼‰
cd admin
npm install --save-dev @cypress/vue

# 2. æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤
# cypress/support/commands.ts:
# - cy.login()
# - cy.logout()
# - cy.createInsight()

# 3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
# cypress/e2e/:
# - login.cy.ts
# - insights-management.cy.ts
# - user-management.cy.ts

# 4. è¿è¡Œæµ‹è¯•
npm run test:e2e

# 5. é›†æˆåˆ°CIï¼ˆä»…PRï¼‰
```

**éªŒæ”¶æ ‡å‡†**:

- [x] è‡³å°‘3ä¸ªE2Eæµ‹è¯•åœºæ™¯
- [x] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [x] CIä¸­ä»…PRæ—¶è¿è¡Œ
- [x] å¤±è´¥æˆªå›¾è‡ªåŠ¨ä¸Šä¼ 

### é˜¶æ®µ6: æ€§èƒ½æµ‹è¯•ï¼ˆP3 - ä½ä¼˜å…ˆçº§ï¼‰

**æ—¶é—´**: 1-2å¤©

```bash
# 1. å®‰è£…Artillery
cd backend
npm install --save-dev artillery

# 2. åˆ›å»ºæ€§èƒ½æµ‹è¯•é…ç½®
# tests/performance/load-test.yml

# 3. å®šä¹‰æµ‹è¯•åœºæ™¯
# - ç™»å½•æ¥å£: 100 req/s
# - æ‰“å¡æ¥å£: 50 req/s
# - æŸ¥è¯¢æ¥å£: 200 req/s

# 4. æ‰‹åŠ¨è¿è¡Œ
npm run test:load

# 5. åŠ å…¥å®šæœŸä»»åŠ¡ï¼ˆæ¯å‘¨ï¼‰
```

**éªŒæ”¶æ ‡å‡†**:

- [x] æ€§èƒ½æµ‹è¯•é…ç½®å®Œæˆ
- [x] åŸºå‡†æ€§èƒ½å·²è®°å½•
- [x] å¯æ‰‹åŠ¨æ‰§è¡Œ
- [x] æ¯å‘¨è‡ªåŠ¨è¿è¡Œ

---

## ğŸ“Š é¢„æœŸæ”¶ç›Š

### 1. å¼€å‘æ•ˆç‡

| æŒ‡æ ‡         | ç°çŠ¶      | ç›®æ ‡       | æå‡  |
| ------------ | --------- | ---------- | ----- |
| Bugä¿®å¤æ—¶é—´  | 2å°æ—¶     | 30åˆ†é’Ÿ     | 75% â†“ |
| é‡å¤é—®é¢˜     | 30%       | 5%         | 83% â†“ |
| éƒ¨ç½²ä¿¡å¿ƒ     | 60%       | 95%        | 58% â†‘ |
| å›å½’æµ‹è¯•æ—¶é—´ | æ‰‹åŠ¨4å°æ—¶ | è‡ªåŠ¨15åˆ†é’Ÿ | 94% â†“ |

### 2. ä»£ç è´¨é‡

| æŒ‡æ ‡         | ç°çŠ¶    | ç›®æ ‡   |
| ------------ | ------- | ------ |
| æµ‹è¯•è¦†ç›–ç‡   | 40%     | 70%    |
| å…³é”®è·¯å¾„è¦†ç›– | 60%     | 100%   |
| ç”Ÿäº§ç¯å¢ƒBug  | 10ä¸ª/æœˆ | 2ä¸ª/æœˆ |
| ä»£ç è§„èŒƒé—®é¢˜ | 50ä¸ª/PR | 0ä¸ª/PR |

### 3. å›¢é˜Ÿåä½œ

| æŒ‡æ ‡          | ç°çŠ¶  | ç›®æ ‡  |
| ------------- | ----- | ----- |
| PR Reviewæ—¶é—´ | 4å°æ—¶ | 1å°æ—¶ |
| æ–°äººä¸Šæ‰‹æ—¶é—´  | 3å¤©   | 1å¤©   |
| æ–‡æ¡£å®Œæ•´åº¦    | 50%   | 90%   |

---

## âš ï¸ é£é™©ä¸åº”å¯¹

### é£é™©1: æµ‹è¯•æ‰§è¡Œæ—¶é—´è¿‡é•¿

**å½±å“**: å¼€å‘è€…è·³è¿‡æµ‹è¯•æˆ–ä½¿ç”¨ `--no-verify`

**åº”å¯¹**:

- Pre-commitä»…è¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆ< 3åˆ†é’Ÿï¼‰
- å…è®¸è·³è¿‡ä½†è®°å½•è­¦å‘Š
- ä¼˜åŒ–æµ‹è¯•å¹¶è¡Œæ‰§è¡Œ
- ä½¿ç”¨å¢é‡æµ‹è¯•ï¼ˆä»…æµ‹ä¿®æ”¹æ–‡ä»¶ï¼‰

### é£é™©2: æµ‹è¯•ç»´æŠ¤æˆæœ¬é«˜

**å½±å“**: æµ‹è¯•è¿‡æ—¶æˆ–å¤±æ•ˆ

**åº”å¯¹**:

- ç¼–å†™ç¨³å®šçš„æµ‹è¯•ï¼ˆé¿å…ä¾èµ–å®ç°ç»†èŠ‚ï¼‰
- ä½¿ç”¨Page Objectæ¨¡å¼ï¼ˆE2Eï¼‰
- å®šæœŸå®¡æŸ¥æµ‹è¯•è´¨é‡
- åˆ é™¤é‡å¤æˆ–æ— æ•ˆæµ‹è¯•

### é£é™©3: CIæˆæœ¬å¢åŠ 

**å½±å“**: GitHub Actionså…è´¹é¢åº¦ä¸è¶³

**åº”å¯¹**:

- ä¼˜åŒ–CIå¹¶è¡Œåº¦ï¼ˆå‡å°‘æ€»æ—¶é—´ï¼‰
- E2Eæµ‹è¯•ä»…åœ¨PRæ—¶è¿è¡Œ
- å®šæœŸä»»åŠ¡ä»…æ¯å¤©ä¸€æ¬¡
- è€ƒè™‘ä½¿ç”¨è‡ªå»ºCIï¼ˆå¦‚æœ‰å¿…è¦ï¼‰

**é¢„ä¼°æˆæœ¬**: GitHub Free: 2000åˆ†é’Ÿ/æœˆï¼Œé¢„è®¡ä½¿ç”¨: ~1500åˆ†é’Ÿ/æœˆï¼ˆå®‰å…¨èŒƒå›´å†…ï¼‰

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

### çŸ­æœŸï¼ˆ1ä¸ªæœˆï¼‰

- [x] æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡
- [x] Git Hooksæ­£å¸¸è¿è¡Œ
- [x] CI/CDæˆåŠŸéƒ¨ç½²
- [x] è¦†ç›–ç‡è¾¾åˆ°60%

### ä¸­æœŸï¼ˆ3ä¸ªæœˆï¼‰

- [x] è¦†ç›–ç‡è¾¾åˆ°70%
- [x] E2Eæµ‹è¯•è¦†ç›–æ ¸å¿ƒåœºæ™¯
- [x] ç”Ÿäº§Bugå‡å°‘50%
- [x] PR Reviewæ—¶é—´å‡å°‘50%

### é•¿æœŸï¼ˆ6ä¸ªæœˆï¼‰

- [x] è¦†ç›–ç‡ç¨³å®šåœ¨75%+
- [x] é›¶ç”Ÿäº§ç¯å¢ƒä¸¥é‡Bug
- [x] è‡ªåŠ¨åŒ–ç‡è¾¾åˆ°95%
- [x] å›¢é˜Ÿæµ‹è¯•æ–‡åŒ–å»ºç«‹

---

## ğŸ› ï¸ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### å®‰è£…

```bash
# 1. å®‰è£…Backendä¾èµ–
cd backend
npm install --save-dev artillery newman @faker-js/faker nock

# 2. å®‰è£…Adminä¾èµ–
cd ../admin
npm install --save-dev vitest @vue/test-utils @vitest/ui c8 happy-dom

# 3. å®‰è£…Git Hooks
cd ..
./scripts/install-test-hooks.sh
```

### è¿è¡Œæµ‹è¯•

```bash
# Backend
cd backend
npm run test:unit          # å•å…ƒæµ‹è¯•
npm run test:integration   # é›†æˆæµ‹è¯•
npm run test:coverage      # è¦†ç›–ç‡

# Admin
cd admin
npm run test:unit          # å•å…ƒæµ‹è¯•
npm run test:ui            # UIæ¨¡å¼
npm run test:e2e           # E2Eæµ‹è¯•
```

### ä¿®å¤é—®é¢˜

```bash
# ä¿®å¤Mochaæµ‹è¯•
./scripts/fix-mocha-tests.sh

# æ ¼å¼åŒ–ä»£ç 
npx prettier --write .

# ä¿®å¤Linté—®é¢˜
cd backend && npm run lint:fix
cd admin && npm run lint:fix
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£                         | ç”¨é€”                   |
| ---------------------------- | ---------------------- |
| `TESTING_STRATEGY.md`        | å®Œæ•´æµ‹è¯•ç­–ç•¥å’ŒæŠ€æœ¯ç»†èŠ‚ |
| `TESTING_QUICKSTART.md`      | 30åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹æŒ‡å—     |
| `TESTING_PACKAGE_UPDATES.md` | ä¾èµ–å’Œé…ç½®æ›´æ–°å»ºè®®     |
| `DEVELOPMENT.md`             | å¼€å‘æµç¨‹å’Œè§„èŒƒ         |
| `BUG_FIXES.md`               | å†å²é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ     |

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•

1. ç¡®å®šæµ‹è¯•ç±»å‹ï¼ˆå•å…ƒ/é›†æˆ/E2Eï¼‰
2. é€‰æ‹©åˆé€‚çš„ä½ç½®ï¼ˆ`tests/unit/`ã€`tests/integration/`ç­‰ï¼‰
3. éµå¾ªç°æœ‰æµ‹è¯•çš„å‘½åå’Œç»“æ„
4. ç¼–å†™æ¸…æ™°çš„æµ‹è¯•æè¿°
5. ç¡®ä¿æµ‹è¯•é€šè¿‡åæäº¤

### æŠ¥å‘Šæµ‹è¯•é—®é¢˜

1. æ£€æŸ¥ `TESTING_QUICKSTART.md` çš„å¸¸è§é—®é¢˜
2. åœ¨GitHub Issuesä¸­åˆ›å»ºæ–°issue
3. æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¤ç°æ­¥éª¤
4. æ ‡è®°ä¸º `test` æ ‡ç­¾

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä»“åº“**: https://github.com/flylion816/Morning_Reading_Club
- **Issues**: https://github.com/flylion816/Morning_Reading_Club/issues
- **æ–‡æ¡£ç»´æŠ¤**: Claude Code

---

**æœ€åæ›´æ–°**: 2025-12-17
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: è®¾è®¡å®Œæˆï¼Œå¾…å®æ–½
