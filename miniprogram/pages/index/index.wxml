<!--首页 - 期次列表-->
<view class="page-index">
  <!-- 顶部横幅 -->
  <view class="home-banner">
    <view class="banner-text-container">
      <text class="banner-text">☀️ 天天开心！</text>
      <text class="banner-subtext">在晨光中,遇见更好的自己</text>
    </view>
  </view>

  <!-- 期次列表 -->
  <view class="periods-container">
    <view
      wx:for="{{periods}}"
      wx:key="_id"
      class="period-wrapper"
      bindtap="handlePeriodClick"
      data-period-id="{{item._id}}"
      data-period-name="{{item.name}}"
    >
      <course-card
        course="{{item}}"
        mode="period"
        enrolled="{{periodEnrollmentStatus[item._id] || {isEnrolled: false, paymentStatus: null, enrollmentId: null}}}"
      />

      <!-- 报名状态标签 -->
      <view wx:if="{{periodEnrollmentStatus[item._id]}}">
        <!-- 已报名 -->
        <view class="enrollment-label enrolled" wx:if="{{periodEnrollmentStatus[item._id].isEnrolled}}">
          <text class="label-text">✓ 已报名</text>
        </view>
        <!-- 未报名 -->
        <view class="enrollment-label not-enrolled" wx:if="{{!periodEnrollmentStatus[item._id].isEnrolled}}">
          <text class="label-text">未报名</text>
        </view>
      </view>
    </view>

    <!-- 加载中 -->
    <view wx:if="{{loading && periods.length === 0}}" class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 空状态 -->
    <view wx:if="{{!loading && periods.length === 0}}" class="empty-state">
      <text class="empty-state-icon">📚</text>
      <text class="empty-state-text">暂无期次</text>
    </view>
  </view>
</view>
