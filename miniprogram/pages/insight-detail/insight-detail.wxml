<view class="page-insight-detail">
  <!-- 顶部课程标题卡片 -->
  <view class="detail-header">
    <view class="day-title">{{insight.title}}<text class="day-period">{{insight.periodName}}</text></view>
    <view class="day-subtitle">你的个性化学习反馈</view>
  </view>

  <!-- 内容区 -->
  <view class="content-section">
    <!-- 小凡看见标题 -->
    <view class="section-title">小凡看见</view>

    <!-- 正文内容 -->
    <view class="content-text">
      <rich-text nodes="{{insight.content}}" />
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="action-buttons">
    <button class="btn-back" bindtap="handleBack">返回</button>
    <button class="btn-share" bindtap="handleCustomShare">分享这个看见</button>
  </view>

  <!-- 转发选择弹窗 -->
  <view class="share-modal" wx:if="{{showShareModal}}" bindtap="closeShareModal">
    <view class="share-modal-content" catchtap>
      <view class="share-modal-title">发送给：</view>

      <!-- 虚拟好友 -->
      <view class="share-friend-item" bindtap="handleShareToVirtualFriend">
        <image class="friend-avatar" src="{{virtualFriend.avatar}}" />
        <view class="friend-info">
          <view class="friend-name">{{virtualFriend.name}}</view>
          <view class="friend-desc">虚拟好友</view>
        </view>
        <view class="friend-arrow">›</view>
      </view>

      <!-- 真实好友 (如果需要) -->
      <view class="share-friend-item" bindtap="handleShareToWechat">
        <image class="friend-avatar" src="{{wechatFriend.avatar}}" />
        <view class="friend-info">
          <view class="friend-name">{{wechatFriend.name}}</view>
          <view class="friend-desc">微信好友</view>
        </view>
        <view class="friend-arrow">›</view>
      </view>

      <view class="share-modal-cancel" bindtap="closeShareModal">取消</view>
    </view>
  </view>

  <!-- 转发成功提示 -->
  <view class="share-success-modal" wx:if="{{showShareSuccess}}">
    <view class="success-content">
      <image src="{{shareSuccessInfo.avatar}}" class="success-avatar" />
      <view class="success-text">成功分享给</view>
      <view class="success-name">{{shareSuccessInfo.name}}</view>
      <view class="success-hint">对方可以查看你的学习反馈</view>
    </view>
  </view>
</view>
